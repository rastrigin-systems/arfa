{
  "name": "pivot",
  "tables": [
    {
      "name": "public.organizations",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "slug",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "plan",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'starter'::character varying"
        },
        {
          "name": "settings",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "max_employees",
          "type": "integer",
          "nullable": false,
          "default": "10"
        },
        {
          "name": "max_agents_per_employee",
          "type": "integer",
          "nullable": false,
          "default": "3"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "organizations_pkey",
          "def": "CREATE UNIQUE INDEX organizations_pkey ON public.organizations USING btree (id)",
          "table": "public.organizations",
          "columns": [
            "id"
          ]
        },
        {
          "name": "organizations_slug_key",
          "def": "CREATE UNIQUE INDEX organizations_slug_key ON public.organizations USING btree (slug)",
          "table": "public.organizations",
          "columns": [
            "slug"
          ]
        },
        {
          "name": "idx_organizations_slug",
          "def": "CREATE INDEX idx_organizations_slug ON public.organizations USING btree (slug)",
          "table": "public.organizations",
          "columns": [
            "slug"
          ]
        }
      ],
      "constraints": [
        {
          "name": "organizations_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.organizations",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "organizations_slug_key",
          "type": "UNIQUE",
          "def": "UNIQUE (slug)",
          "table": "public.organizations",
          "referenced_table": "",
          "columns": [
            "slug"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_organizations_updated_at",
          "def": "CREATE TRIGGER update_organizations_updated_at BEFORE UPDATE ON public.organizations FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.subscriptions",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "plan_type",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "monthly_budget_usd",
          "type": "numeric(10,2)",
          "nullable": false,
          "default": "100.00"
        },
        {
          "name": "current_spending_usd",
          "type": "numeric(10,2)",
          "nullable": false,
          "default": "0.00"
        },
        {
          "name": "billing_period_start",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "billing_period_end",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'active'::character varying"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "subscriptions_pkey",
          "def": "CREATE UNIQUE INDEX subscriptions_pkey ON public.subscriptions USING btree (id)",
          "table": "public.subscriptions",
          "columns": [
            "id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "subscriptions_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.subscriptions",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "subscriptions_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.subscriptions",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_subscriptions_updated_at",
          "def": "CREATE TRIGGER update_subscriptions_updated_at BEFORE UPDATE ON public.subscriptions FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.teams",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "teams_pkey",
          "def": "CREATE UNIQUE INDEX teams_pkey ON public.teams USING btree (id)",
          "table": "public.teams",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_team_name_per_org",
          "def": "CREATE UNIQUE INDEX unique_team_name_per_org ON public.teams USING btree (org_id, name)",
          "table": "public.teams",
          "columns": [
            "org_id",
            "name"
          ]
        },
        {
          "name": "idx_teams_org_id",
          "def": "CREATE INDEX idx_teams_org_id ON public.teams USING btree (org_id)",
          "table": "public.teams",
          "columns": [
            "org_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "teams_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.teams",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "teams_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.teams",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_team_name_per_org",
          "type": "UNIQUE",
          "def": "UNIQUE (org_id, name)",
          "table": "public.teams",
          "referenced_table": "",
          "columns": [
            "org_id",
            "name"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_teams_updated_at",
          "def": "CREATE TRIGGER update_teams_updated_at BEFORE UPDATE ON public.teams FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.roles",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": true
        },
        {
          "name": "permissions",
          "type": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "roles_pkey",
          "def": "CREATE UNIQUE INDEX roles_pkey ON public.roles USING btree (id)",
          "table": "public.roles",
          "columns": [
            "id"
          ]
        },
        {
          "name": "roles_name_key",
          "def": "CREATE UNIQUE INDEX roles_name_key ON public.roles USING btree (name)",
          "table": "public.roles",
          "columns": [
            "name"
          ]
        }
      ],
      "constraints": [
        {
          "name": "roles_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.roles",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "roles_name_key",
          "type": "UNIQUE",
          "def": "UNIQUE (name)",
          "table": "public.roles",
          "referenced_table": "",
          "columns": [
            "name"
          ]
        }
      ]
    },
    {
      "name": "public.employees",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "team_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "role_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "email",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "full_name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "password_hash",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'active'::character varying"
        },
        {
          "name": "preferences",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "last_login_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "employees_pkey",
          "def": "CREATE UNIQUE INDEX employees_pkey ON public.employees USING btree (id)",
          "table": "public.employees",
          "columns": [
            "id"
          ]
        },
        {
          "name": "employees_email_key",
          "def": "CREATE UNIQUE INDEX employees_email_key ON public.employees USING btree (email)",
          "table": "public.employees",
          "columns": [
            "email"
          ]
        },
        {
          "name": "idx_employees_org_id",
          "def": "CREATE INDEX idx_employees_org_id ON public.employees USING btree (org_id)",
          "table": "public.employees",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "idx_employees_team_id",
          "def": "CREATE INDEX idx_employees_team_id ON public.employees USING btree (team_id)",
          "table": "public.employees",
          "columns": [
            "team_id"
          ]
        },
        {
          "name": "idx_employees_email",
          "def": "CREATE INDEX idx_employees_email ON public.employees USING btree (email)",
          "table": "public.employees",
          "columns": [
            "email"
          ]
        },
        {
          "name": "idx_employees_status",
          "def": "CREATE INDEX idx_employees_status ON public.employees USING btree (status)",
          "table": "public.employees",
          "columns": [
            "status"
          ]
        }
      ],
      "constraints": [
        {
          "name": "employees_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.employees",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employees_team_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE SET NULL",
          "table": "public.employees",
          "referenced_table": "teams",
          "columns": [
            "team_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employees_role_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (role_id) REFERENCES roles(id)",
          "table": "public.employees",
          "referenced_table": "roles",
          "columns": [
            "role_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employees_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.employees",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "employees_email_key",
          "type": "UNIQUE",
          "def": "UNIQUE (email)",
          "table": "public.employees",
          "referenced_table": "",
          "columns": [
            "email"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_employees_updated_at",
          "def": "CREATE TRIGGER update_employees_updated_at BEFORE UPDATE ON public.employees FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.sessions",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "token_hash",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "ip_address",
          "type": "varchar(45)",
          "nullable": true
        },
        {
          "name": "user_agent",
          "type": "text",
          "nullable": true
        },
        {
          "name": "expires_at",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "sessions_pkey",
          "def": "CREATE UNIQUE INDEX sessions_pkey ON public.sessions USING btree (id)",
          "table": "public.sessions",
          "columns": [
            "id"
          ]
        },
        {
          "name": "sessions_token_hash_key",
          "def": "CREATE UNIQUE INDEX sessions_token_hash_key ON public.sessions USING btree (token_hash)",
          "table": "public.sessions",
          "columns": [
            "token_hash"
          ]
        },
        {
          "name": "idx_sessions_employee_id",
          "def": "CREATE INDEX idx_sessions_employee_id ON public.sessions USING btree (employee_id)",
          "table": "public.sessions",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_sessions_token_hash",
          "def": "CREATE INDEX idx_sessions_token_hash ON public.sessions USING btree (token_hash)",
          "table": "public.sessions",
          "columns": [
            "token_hash"
          ]
        },
        {
          "name": "idx_sessions_expires_at",
          "def": "CREATE INDEX idx_sessions_expires_at ON public.sessions USING btree (expires_at)",
          "table": "public.sessions",
          "columns": [
            "expires_at"
          ]
        }
      ],
      "constraints": [
        {
          "name": "sessions_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.sessions",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "sessions_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.sessions",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "sessions_token_hash_key",
          "type": "UNIQUE",
          "def": "UNIQUE (token_hash)",
          "table": "public.sessions",
          "referenced_table": "",
          "columns": [
            "token_hash"
          ]
        }
      ]
    },
    {
      "name": "public.agent_catalog",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "type",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": false
        },
        {
          "name": "provider",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "default_config",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "capabilities",
          "type": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb"
        },
        {
          "name": "llm_provider",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'anthropic'::character varying"
        },
        {
          "name": "llm_model",
          "type": "varchar(100)",
          "nullable": false,
          "default": "'claude-3-5-sonnet-20241022'::character varying"
        },
        {
          "name": "is_public",
          "type": "boolean",
          "nullable": false,
          "default": "true"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "agent_catalog_pkey",
          "def": "CREATE UNIQUE INDEX agent_catalog_pkey ON public.agent_catalog USING btree (id)",
          "table": "public.agent_catalog",
          "columns": [
            "id"
          ]
        },
        {
          "name": "agent_catalog_name_key",
          "def": "CREATE UNIQUE INDEX agent_catalog_name_key ON public.agent_catalog USING btree (name)",
          "table": "public.agent_catalog",
          "columns": [
            "name"
          ]
        }
      ],
      "constraints": [
        {
          "name": "agent_catalog_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.agent_catalog",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "agent_catalog_name_key",
          "type": "UNIQUE",
          "def": "UNIQUE (name)",
          "table": "public.agent_catalog",
          "referenced_table": "",
          "columns": [
            "name"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_agent_catalog_updated_at",
          "def": "CREATE TRIGGER update_agent_catalog_updated_at BEFORE UPDATE ON public.agent_catalog FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.tools",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "type",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": false
        },
        {
          "name": "schema",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "requires_approval",
          "type": "boolean",
          "nullable": false,
          "default": "false"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "tools_pkey",
          "def": "CREATE UNIQUE INDEX tools_pkey ON public.tools USING btree (id)",
          "table": "public.tools",
          "columns": [
            "id"
          ]
        },
        {
          "name": "tools_name_key",
          "def": "CREATE UNIQUE INDEX tools_name_key ON public.tools USING btree (name)",
          "table": "public.tools",
          "columns": [
            "name"
          ]
        }
      ],
      "constraints": [
        {
          "name": "tools_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.tools",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "tools_name_key",
          "type": "UNIQUE",
          "def": "UNIQUE (name)",
          "table": "public.tools",
          "referenced_table": "",
          "columns": [
            "name"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_tools_updated_at",
          "def": "CREATE TRIGGER update_tools_updated_at BEFORE UPDATE ON public.tools FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.policies",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "type",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "rules",
          "type": "jsonb",
          "nullable": false
        },
        {
          "name": "severity",
          "type": "varchar(20)",
          "nullable": false,
          "default": "'warn'::character varying"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "policies_pkey",
          "def": "CREATE UNIQUE INDEX policies_pkey ON public.policies USING btree (id)",
          "table": "public.policies",
          "columns": [
            "id"
          ]
        },
        {
          "name": "policies_name_key",
          "def": "CREATE UNIQUE INDEX policies_name_key ON public.policies USING btree (name)",
          "table": "public.policies",
          "columns": [
            "name"
          ]
        }
      ],
      "constraints": [
        {
          "name": "policies_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.policies",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "policies_name_key",
          "type": "UNIQUE",
          "def": "UNIQUE (name)",
          "table": "public.policies",
          "referenced_table": "",
          "columns": [
            "name"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_policies_updated_at",
          "def": "CREATE TRIGGER update_policies_updated_at BEFORE UPDATE ON public.policies FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.agent_tools",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "agent_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "tool_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "config",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "agent_tools_pkey",
          "def": "CREATE UNIQUE INDEX agent_tools_pkey ON public.agent_tools USING btree (agent_id, tool_id)",
          "table": "public.agent_tools",
          "columns": [
            "agent_id",
            "tool_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "agent_tools_agent_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (agent_id) REFERENCES agent_catalog(id) ON DELETE CASCADE",
          "table": "public.agent_tools",
          "referenced_table": "agent_catalog",
          "columns": [
            "agent_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "agent_tools_tool_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (tool_id) REFERENCES tools(id) ON DELETE CASCADE",
          "table": "public.agent_tools",
          "referenced_table": "tools",
          "columns": [
            "tool_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "agent_tools_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (agent_id, tool_id)",
          "table": "public.agent_tools",
          "referenced_table": "",
          "columns": [
            "agent_id",
            "tool_id"
          ]
        }
      ]
    },
    {
      "name": "public.agent_policies",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "agent_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "policy_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "agent_policies_pkey",
          "def": "CREATE UNIQUE INDEX agent_policies_pkey ON public.agent_policies USING btree (agent_id, policy_id)",
          "table": "public.agent_policies",
          "columns": [
            "agent_id",
            "policy_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "agent_policies_agent_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (agent_id) REFERENCES agent_catalog(id) ON DELETE CASCADE",
          "table": "public.agent_policies",
          "referenced_table": "agent_catalog",
          "columns": [
            "agent_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "agent_policies_policy_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (policy_id) REFERENCES policies(id) ON DELETE CASCADE",
          "table": "public.agent_policies",
          "referenced_table": "policies",
          "columns": [
            "policy_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "agent_policies_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (agent_id, policy_id)",
          "table": "public.agent_policies",
          "referenced_table": "",
          "columns": [
            "agent_id",
            "policy_id"
          ]
        }
      ]
    },
    {
      "name": "public.team_policies",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "team_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "policy_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "overrides",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "team_policies_pkey",
          "def": "CREATE UNIQUE INDEX team_policies_pkey ON public.team_policies USING btree (id)",
          "table": "public.team_policies",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_team_policy",
          "def": "CREATE UNIQUE INDEX unique_team_policy ON public.team_policies USING btree (team_id, policy_id)",
          "table": "public.team_policies",
          "columns": [
            "team_id",
            "policy_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "team_policies_team_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE CASCADE",
          "table": "public.team_policies",
          "referenced_table": "teams",
          "columns": [
            "team_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "team_policies_policy_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (policy_id) REFERENCES policies(id) ON DELETE CASCADE",
          "table": "public.team_policies",
          "referenced_table": "policies",
          "columns": [
            "policy_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "team_policies_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.team_policies",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_team_policy",
          "type": "UNIQUE",
          "def": "UNIQUE (team_id, policy_id)",
          "table": "public.team_policies",
          "referenced_table": "",
          "columns": [
            "team_id",
            "policy_id"
          ]
        }
      ]
    },
    {
      "name": "public.employee_agent_configs",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "agent_catalog_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'active'::character varying"
        },
        {
          "name": "config_override",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "sync_token",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "last_sync_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "employee_agent_configs_pkey",
          "def": "CREATE UNIQUE INDEX employee_agent_configs_pkey ON public.employee_agent_configs USING btree (id)",
          "table": "public.employee_agent_configs",
          "columns": [
            "id"
          ]
        },
        {
          "name": "employee_agent_configs_sync_token_key",
          "def": "CREATE UNIQUE INDEX employee_agent_configs_sync_token_key ON public.employee_agent_configs USING btree (sync_token)",
          "table": "public.employee_agent_configs",
          "columns": [
            "sync_token"
          ]
        },
        {
          "name": "unique_agent_name_per_employee",
          "def": "CREATE UNIQUE INDEX unique_agent_name_per_employee ON public.employee_agent_configs USING btree (employee_id, name)",
          "table": "public.employee_agent_configs",
          "columns": [
            "employee_id",
            "name"
          ]
        },
        {
          "name": "idx_employee_agent_configs_employee_id",
          "def": "CREATE INDEX idx_employee_agent_configs_employee_id ON public.employee_agent_configs USING btree (employee_id)",
          "table": "public.employee_agent_configs",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_employee_agent_configs_agent_catalog_id",
          "def": "CREATE INDEX idx_employee_agent_configs_agent_catalog_id ON public.employee_agent_configs USING btree (agent_catalog_id)",
          "table": "public.employee_agent_configs",
          "columns": [
            "agent_catalog_id"
          ]
        },
        {
          "name": "idx_employee_agent_configs_status",
          "def": "CREATE INDEX idx_employee_agent_configs_status ON public.employee_agent_configs USING btree (status)",
          "table": "public.employee_agent_configs",
          "columns": [
            "status"
          ]
        },
        {
          "name": "idx_employee_agent_configs_sync_token",
          "def": "CREATE INDEX idx_employee_agent_configs_sync_token ON public.employee_agent_configs USING btree (sync_token) WHERE (sync_token IS NOT NULL)",
          "table": "public.employee_agent_configs",
          "columns": [
            "sync_token"
          ]
        }
      ],
      "constraints": [
        {
          "name": "employee_agent_configs_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.employee_agent_configs",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employee_agent_configs_agent_catalog_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (agent_catalog_id) REFERENCES agent_catalog(id) ON DELETE RESTRICT",
          "table": "public.employee_agent_configs",
          "referenced_table": "agent_catalog",
          "columns": [
            "agent_catalog_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employee_agent_configs_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.employee_agent_configs",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "employee_agent_configs_sync_token_key",
          "type": "UNIQUE",
          "def": "UNIQUE (sync_token)",
          "table": "public.employee_agent_configs",
          "referenced_table": "",
          "columns": [
            "sync_token"
          ]
        },
        {
          "name": "unique_agent_name_per_employee",
          "type": "UNIQUE",
          "def": "UNIQUE (employee_id, name)",
          "table": "public.employee_agent_configs",
          "referenced_table": "",
          "columns": [
            "employee_id",
            "name"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_employee_agent_configs_updated_at",
          "def": "CREATE TRIGGER update_employee_agent_configs_updated_at BEFORE UPDATE ON public.employee_agent_configs FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        },
        {
          "name": "generate_agent_config_sync_token",
          "def": "CREATE TRIGGER generate_agent_config_sync_token BEFORE INSERT ON public.employee_agent_configs FOR EACH ROW EXECUTE FUNCTION generate_sync_token()"
        }
      ]
    },
    {
      "name": "public.mcp_categories",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "mcp_categories_pkey",
          "def": "CREATE UNIQUE INDEX mcp_categories_pkey ON public.mcp_categories USING btree (id)",
          "table": "public.mcp_categories",
          "columns": [
            "id"
          ]
        },
        {
          "name": "mcp_categories_name_key",
          "def": "CREATE UNIQUE INDEX mcp_categories_name_key ON public.mcp_categories USING btree (name)",
          "table": "public.mcp_categories",
          "columns": [
            "name"
          ]
        }
      ],
      "constraints": [
        {
          "name": "mcp_categories_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.mcp_categories",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "mcp_categories_name_key",
          "type": "UNIQUE",
          "def": "UNIQUE (name)",
          "table": "public.mcp_categories",
          "referenced_table": "",
          "columns": [
            "name"
          ]
        }
      ]
    },
    {
      "name": "public.mcp_catalog",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "provider",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "version",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": false
        },
        {
          "name": "connection_schema",
          "type": "jsonb",
          "nullable": false
        },
        {
          "name": "capabilities",
          "type": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb"
        },
        {
          "name": "requires_credentials",
          "type": "boolean",
          "nullable": false,
          "default": "false"
        },
        {
          "name": "is_approved",
          "type": "boolean",
          "nullable": false,
          "default": "false"
        },
        {
          "name": "category_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "mcp_catalog_pkey",
          "def": "CREATE UNIQUE INDEX mcp_catalog_pkey ON public.mcp_catalog USING btree (id)",
          "table": "public.mcp_catalog",
          "columns": [
            "id"
          ]
        },
        {
          "name": "mcp_catalog_name_key",
          "def": "CREATE UNIQUE INDEX mcp_catalog_name_key ON public.mcp_catalog USING btree (name)",
          "table": "public.mcp_catalog",
          "columns": [
            "name"
          ]
        }
      ],
      "constraints": [
        {
          "name": "mcp_catalog_category_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (category_id) REFERENCES mcp_categories(id) ON DELETE SET NULL",
          "table": "public.mcp_catalog",
          "referenced_table": "mcp_categories",
          "columns": [
            "category_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "mcp_catalog_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.mcp_catalog",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "mcp_catalog_name_key",
          "type": "UNIQUE",
          "def": "UNIQUE (name)",
          "table": "public.mcp_catalog",
          "referenced_table": "",
          "columns": [
            "name"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_mcp_catalog_updated_at",
          "def": "CREATE TRIGGER update_mcp_catalog_updated_at BEFORE UPDATE ON public.mcp_catalog FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.employee_mcp_configs",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "mcp_catalog_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'pending'::character varying"
        },
        {
          "name": "connection_config",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "credentials_encrypted",
          "type": "text",
          "nullable": true
        },
        {
          "name": "sync_token",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "last_sync_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "employee_mcp_configs_pkey",
          "def": "CREATE UNIQUE INDEX employee_mcp_configs_pkey ON public.employee_mcp_configs USING btree (id)",
          "table": "public.employee_mcp_configs",
          "columns": [
            "id"
          ]
        },
        {
          "name": "employee_mcp_configs_sync_token_key",
          "def": "CREATE UNIQUE INDEX employee_mcp_configs_sync_token_key ON public.employee_mcp_configs USING btree (sync_token)",
          "table": "public.employee_mcp_configs",
          "columns": [
            "sync_token"
          ]
        },
        {
          "name": "unique_employee_mcp",
          "def": "CREATE UNIQUE INDEX unique_employee_mcp ON public.employee_mcp_configs USING btree (employee_id, mcp_catalog_id)",
          "table": "public.employee_mcp_configs",
          "columns": [
            "employee_id",
            "mcp_catalog_id"
          ]
        },
        {
          "name": "idx_employee_mcp_configs_employee_id",
          "def": "CREATE INDEX idx_employee_mcp_configs_employee_id ON public.employee_mcp_configs USING btree (employee_id)",
          "table": "public.employee_mcp_configs",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_employee_mcp_configs_mcp_catalog_id",
          "def": "CREATE INDEX idx_employee_mcp_configs_mcp_catalog_id ON public.employee_mcp_configs USING btree (mcp_catalog_id)",
          "table": "public.employee_mcp_configs",
          "columns": [
            "mcp_catalog_id"
          ]
        },
        {
          "name": "idx_employee_mcp_configs_status",
          "def": "CREATE INDEX idx_employee_mcp_configs_status ON public.employee_mcp_configs USING btree (status)",
          "table": "public.employee_mcp_configs",
          "columns": [
            "status"
          ]
        },
        {
          "name": "idx_employee_mcp_configs_sync_token",
          "def": "CREATE INDEX idx_employee_mcp_configs_sync_token ON public.employee_mcp_configs USING btree (sync_token) WHERE (sync_token IS NOT NULL)",
          "table": "public.employee_mcp_configs",
          "columns": [
            "sync_token"
          ]
        }
      ],
      "constraints": [
        {
          "name": "employee_mcp_configs_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.employee_mcp_configs",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employee_mcp_configs_mcp_catalog_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (mcp_catalog_id) REFERENCES mcp_catalog(id) ON DELETE CASCADE",
          "table": "public.employee_mcp_configs",
          "referenced_table": "mcp_catalog",
          "columns": [
            "mcp_catalog_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employee_mcp_configs_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.employee_mcp_configs",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "employee_mcp_configs_sync_token_key",
          "type": "UNIQUE",
          "def": "UNIQUE (sync_token)",
          "table": "public.employee_mcp_configs",
          "referenced_table": "",
          "columns": [
            "sync_token"
          ]
        },
        {
          "name": "unique_employee_mcp",
          "type": "UNIQUE",
          "def": "UNIQUE (employee_id, mcp_catalog_id)",
          "table": "public.employee_mcp_configs",
          "referenced_table": "",
          "columns": [
            "employee_id",
            "mcp_catalog_id"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_employee_mcp_configs_updated_at",
          "def": "CREATE TRIGGER update_employee_mcp_configs_updated_at BEFORE UPDATE ON public.employee_mcp_configs FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        },
        {
          "name": "generate_mcp_config_sync_token",
          "def": "CREATE TRIGGER generate_mcp_config_sync_token BEFORE INSERT ON public.employee_mcp_configs FOR EACH ROW EXECUTE FUNCTION generate_sync_token()"
        }
      ]
    },
    {
      "name": "public.agent_requests",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "request_type",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "request_data",
          "type": "jsonb",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'pending'::character varying"
        },
        {
          "name": "reason",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "resolved_at",
          "type": "timestamp without time zone",
          "nullable": true
        }
      ],
      "indexes": [
        {
          "name": "agent_requests_pkey",
          "def": "CREATE UNIQUE INDEX agent_requests_pkey ON public.agent_requests USING btree (id)",
          "table": "public.agent_requests",
          "columns": [
            "id"
          ]
        },
        {
          "name": "idx_agent_requests_employee_id",
          "def": "CREATE INDEX idx_agent_requests_employee_id ON public.agent_requests USING btree (employee_id)",
          "table": "public.agent_requests",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_agent_requests_status",
          "def": "CREATE INDEX idx_agent_requests_status ON public.agent_requests USING btree (status)",
          "table": "public.agent_requests",
          "columns": [
            "status"
          ]
        },
        {
          "name": "idx_agent_requests_created_at",
          "def": "CREATE INDEX idx_agent_requests_created_at ON public.agent_requests USING btree (created_at DESC)",
          "table": "public.agent_requests",
          "columns": [
            "created_at"
          ]
        }
      ],
      "constraints": [
        {
          "name": "agent_requests_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.agent_requests",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "agent_requests_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.agent_requests",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ]
    },
    {
      "name": "public.approvals",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "request_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "approver_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "comment",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "resolved_at",
          "type": "timestamp without time zone",
          "nullable": true
        }
      ],
      "indexes": [
        {
          "name": "approvals_pkey",
          "def": "CREATE UNIQUE INDEX approvals_pkey ON public.approvals USING btree (id)",
          "table": "public.approvals",
          "columns": [
            "id"
          ]
        },
        {
          "name": "idx_approvals_request_id",
          "def": "CREATE INDEX idx_approvals_request_id ON public.approvals USING btree (request_id)",
          "table": "public.approvals",
          "columns": [
            "request_id"
          ]
        },
        {
          "name": "idx_approvals_approver_id",
          "def": "CREATE INDEX idx_approvals_approver_id ON public.approvals USING btree (approver_id)",
          "table": "public.approvals",
          "columns": [
            "approver_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "approvals_approver_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (approver_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.approvals",
          "referenced_table": "employees",
          "columns": [
            "approver_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "approvals_request_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (request_id) REFERENCES agent_requests(id) ON DELETE CASCADE",
          "table": "public.approvals",
          "referenced_table": "agent_requests",
          "columns": [
            "request_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "approvals_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.approvals",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ]
    },
    {
      "name": "public.activity_logs",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "event_type",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "event_category",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "payload",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "activity_logs_pkey",
          "def": "CREATE UNIQUE INDEX activity_logs_pkey ON public.activity_logs USING btree (id)",
          "table": "public.activity_logs",
          "columns": [
            "id"
          ]
        },
        {
          "name": "idx_activity_logs_org_id",
          "def": "CREATE INDEX idx_activity_logs_org_id ON public.activity_logs USING btree (org_id)",
          "table": "public.activity_logs",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "idx_activity_logs_employee_id",
          "def": "CREATE INDEX idx_activity_logs_employee_id ON public.activity_logs USING btree (employee_id)",
          "table": "public.activity_logs",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_activity_logs_event_type",
          "def": "CREATE INDEX idx_activity_logs_event_type ON public.activity_logs USING btree (event_type)",
          "table": "public.activity_logs",
          "columns": [
            "event_type"
          ]
        },
        {
          "name": "idx_activity_logs_created_at",
          "def": "CREATE INDEX idx_activity_logs_created_at ON public.activity_logs USING btree (created_at DESC)",
          "table": "public.activity_logs",
          "columns": [
            "created_at"
          ]
        }
      ],
      "constraints": [
        {
          "name": "activity_logs_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.activity_logs",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "activity_logs_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE SET NULL",
          "table": "public.activity_logs",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "activity_logs_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.activity_logs",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ]
    },
    {
      "name": "public.usage_records",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "agent_config_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "resource_type",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "quantity",
          "type": "bigint",
          "nullable": false
        },
        {
          "name": "cost_usd",
          "type": "numeric(10,4)",
          "nullable": false
        },
        {
          "name": "period_start",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "period_end",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "usage_records_pkey",
          "def": "CREATE UNIQUE INDEX usage_records_pkey ON public.usage_records USING btree (id)",
          "table": "public.usage_records",
          "columns": [
            "id"
          ]
        },
        {
          "name": "idx_usage_records_org_id",
          "def": "CREATE INDEX idx_usage_records_org_id ON public.usage_records USING btree (org_id)",
          "table": "public.usage_records",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "idx_usage_records_employee_id",
          "def": "CREATE INDEX idx_usage_records_employee_id ON public.usage_records USING btree (employee_id)",
          "table": "public.usage_records",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_usage_records_agent_config_id",
          "def": "CREATE INDEX idx_usage_records_agent_config_id ON public.usage_records USING btree (agent_config_id)",
          "table": "public.usage_records",
          "columns": [
            "agent_config_id"
          ]
        },
        {
          "name": "idx_usage_records_period",
          "def": "CREATE INDEX idx_usage_records_period ON public.usage_records USING btree (period_start, period_end)",
          "table": "public.usage_records",
          "columns": [
            "period_start",
            "period_end"
          ]
        }
      ],
      "constraints": [
        {
          "name": "usage_records_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.usage_records",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "usage_records_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE SET NULL",
          "table": "public.usage_records",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "usage_records_agent_config_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (agent_config_id) REFERENCES employee_agent_configs(id) ON DELETE SET NULL",
          "table": "public.usage_records",
          "referenced_table": "employee_agent_configs",
          "columns": [
            "agent_config_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "usage_records_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.usage_records",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ]
    },
    {
      "name": "public.v_employee_agents",
      "type": "VIEW",
      "comment": "Complete view of employee agent configurations with catalog details",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "employee_name",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "employee_email",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "agent_name",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "agent_type",
          "type": "varchar(100)",
          "nullable": true
        },
        {
          "name": "provider",
          "type": "varchar(100)",
          "nullable": true
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": true
        },
        {
          "name": "sync_token",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "last_sync_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": true
        }
      ],
      "def": "CREATE VIEW v_employee_agents AS (\n SELECT eac.id,\n    eac.employee_id,\n    e.full_name AS employee_name,\n    e.email AS employee_email,\n    ac.name AS agent_name,\n    ac.type AS agent_type,\n    ac.provider,\n    eac.status,\n    eac.sync_token,\n    eac.last_sync_at,\n    eac.created_at\n   FROM ((employee_agent_configs eac\n     JOIN employees e ON ((eac.employee_id = e.id)))\n     JOIN agent_catalog ac ON ((eac.agent_catalog_id = ac.id)))\n)",
      "referenced_tables": [
        "public.employee_agent_configs",
        "public.employees",
        "public.agent_catalog"
      ]
    },
    {
      "name": "public.v_employee_mcps",
      "type": "VIEW",
      "comment": "Complete view of employee MCP configurations with catalog details",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "employee_name",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "employee_email",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "mcp_name",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "provider",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "version",
          "type": "varchar(50)",
          "nullable": true
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": true
        },
        {
          "name": "sync_token",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "last_sync_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": true
        }
      ],
      "def": "CREATE VIEW v_employee_mcps AS (\n SELECT emc.id,\n    emc.employee_id,\n    e.full_name AS employee_name,\n    e.email AS employee_email,\n    mc.name AS mcp_name,\n    mc.provider,\n    mc.version,\n    emc.status,\n    emc.sync_token,\n    emc.last_sync_at,\n    emc.created_at\n   FROM ((employee_mcp_configs emc\n     JOIN employees e ON ((emc.employee_id = e.id)))\n     JOIN mcp_catalog mc ON ((emc.mcp_catalog_id = mc.id)))\n)",
      "referenced_tables": [
        "public.employee_mcp_configs",
        "public.employees",
        "public.mcp_catalog"
      ]
    },
    {
      "name": "public.v_pending_approvals",
      "type": "VIEW",
      "comment": "Pending approval requests with full requester context",
      "columns": [
        {
          "name": "request_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "request_type",
          "type": "varchar(50)",
          "nullable": true
        },
        {
          "name": "request_data",
          "type": "jsonb",
          "nullable": true
        },
        {
          "name": "reason",
          "type": "text",
          "nullable": true
        },
        {
          "name": "requested_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "requester_name",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "requester_email",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "team_name",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "org_name",
          "type": "varchar(255)",
          "nullable": true
        }
      ],
      "def": "CREATE VIEW v_pending_approvals AS (\n SELECT ar.id AS request_id,\n    ar.request_type,\n    ar.request_data,\n    ar.reason,\n    ar.created_at AS requested_at,\n    e.id AS employee_id,\n    e.full_name AS requester_name,\n    e.email AS requester_email,\n    t.name AS team_name,\n    o.name AS org_name\n   FROM (((agent_requests ar\n     JOIN employees e ON ((ar.employee_id = e.id)))\n     JOIN organizations o ON ((e.org_id = o.id)))\n     LEFT JOIN teams t ON ((e.team_id = t.id)))\n  WHERE ((ar.status)::text = 'pending'::text)\n)",
      "referenced_tables": [
        "public.agent_requests",
        "public.employees",
        "public.organizations",
        "public.teams"
      ]
    }
  ],
  "relations": [
    {
      "table": "public.subscriptions",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.teams",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.employees",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.employees",
      "columns": [
        "team_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.teams",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE SET NULL"
    },
    {
      "table": "public.employees",
      "columns": [
        "role_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.roles",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (role_id) REFERENCES roles(id)"
    },
    {
      "table": "public.sessions",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.agent_tools",
      "columns": [
        "agent_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.agent_catalog",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (agent_id) REFERENCES agent_catalog(id) ON DELETE CASCADE"
    },
    {
      "table": "public.agent_tools",
      "columns": [
        "tool_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.tools",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (tool_id) REFERENCES tools(id) ON DELETE CASCADE"
    },
    {
      "table": "public.agent_policies",
      "columns": [
        "agent_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.agent_catalog",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (agent_id) REFERENCES agent_catalog(id) ON DELETE CASCADE"
    },
    {
      "table": "public.agent_policies",
      "columns": [
        "policy_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.policies",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (policy_id) REFERENCES policies(id) ON DELETE CASCADE"
    },
    {
      "table": "public.team_policies",
      "columns": [
        "team_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.teams",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE CASCADE"
    },
    {
      "table": "public.team_policies",
      "columns": [
        "policy_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.policies",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (policy_id) REFERENCES policies(id) ON DELETE CASCADE"
    },
    {
      "table": "public.employee_agent_configs",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.employee_agent_configs",
      "columns": [
        "agent_catalog_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.agent_catalog",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (agent_catalog_id) REFERENCES agent_catalog(id) ON DELETE RESTRICT"
    },
    {
      "table": "public.mcp_catalog",
      "columns": [
        "category_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.mcp_categories",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (category_id) REFERENCES mcp_categories(id) ON DELETE SET NULL"
    },
    {
      "table": "public.employee_mcp_configs",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.employee_mcp_configs",
      "columns": [
        "mcp_catalog_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.mcp_catalog",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (mcp_catalog_id) REFERENCES mcp_catalog(id) ON DELETE CASCADE"
    },
    {
      "table": "public.agent_requests",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.approvals",
      "columns": [
        "approver_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (approver_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.approvals",
      "columns": [
        "request_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.agent_requests",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (request_id) REFERENCES agent_requests(id) ON DELETE CASCADE"
    },
    {
      "table": "public.activity_logs",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.activity_logs",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE SET NULL"
    },
    {
      "table": "public.usage_records",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.usage_records",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE SET NULL"
    },
    {
      "table": "public.usage_records",
      "columns": [
        "agent_config_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employee_agent_configs",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (agent_config_id) REFERENCES employee_agent_configs(id) ON DELETE SET NULL"
    }
  ],
  "functions": [
    {
      "name": "public.uuid_nil",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_ns_dns",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_ns_url",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_ns_oid",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_ns_x500",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v1",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v1mc",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v3",
      "return_type": "uuid",
      "arguments": "namespace uuid, name text",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v4",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v5",
      "return_type": "uuid",
      "arguments": "namespace uuid, name text",
      "type": "FUNCTION"
    },
    {
      "name": "public.update_updated_at_column",
      "return_type": "trigger",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.generate_sync_token",
      "return_type": "trigger",
      "arguments": "",
      "type": "FUNCTION"
    }
  ],
  "driver": {
    "name": "postgres",
    "database_version": "PostgreSQL 15.14 on aarch64-unknown-linux-musl, compiled by gcc (Alpine 14.2.0) 14.2.0, 64-bit",
    "meta": {
      "current_schema": "public",
      "search_paths": [
        "pivot",
        "public"
      ],
      "dict": {
        "Functions": "Stored procedures and functions"
      }
    }
  }
}
