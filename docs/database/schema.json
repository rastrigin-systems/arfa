{
  "name": "arfa",
  "tables": [
    {
      "name": "public.organizations",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "slug",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "plan",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'starter'::character varying"
        },
        {
          "name": "settings",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "max_employees",
          "type": "integer",
          "nullable": false,
          "default": "10"
        },
        {
          "name": "claude_api_token",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "organizations_pkey",
          "def": "CREATE UNIQUE INDEX organizations_pkey ON public.organizations USING btree (id)",
          "table": "public.organizations",
          "columns": [
            "id"
          ]
        },
        {
          "name": "organizations_slug_key",
          "def": "CREATE UNIQUE INDEX organizations_slug_key ON public.organizations USING btree (slug)",
          "table": "public.organizations",
          "columns": [
            "slug"
          ]
        },
        {
          "name": "idx_organizations_slug",
          "def": "CREATE INDEX idx_organizations_slug ON public.organizations USING btree (slug)",
          "table": "public.organizations",
          "columns": [
            "slug"
          ]
        }
      ],
      "constraints": [
        {
          "name": "organizations_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.organizations",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "organizations_slug_key",
          "type": "UNIQUE",
          "def": "UNIQUE (slug)",
          "table": "public.organizations",
          "referenced_table": "",
          "columns": [
            "slug"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_organizations_updated_at",
          "def": "CREATE TRIGGER update_organizations_updated_at BEFORE UPDATE ON public.organizations FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.subscriptions",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "plan_type",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "monthly_budget_usd",
          "type": "numeric(10,2)",
          "nullable": false,
          "default": "100.00"
        },
        {
          "name": "current_spending_usd",
          "type": "numeric(10,2)",
          "nullable": false,
          "default": "0.00"
        },
        {
          "name": "billing_period_start",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "billing_period_end",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'active'::character varying"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "subscriptions_pkey",
          "def": "CREATE UNIQUE INDEX subscriptions_pkey ON public.subscriptions USING btree (id)",
          "table": "public.subscriptions",
          "columns": [
            "id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "subscriptions_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.subscriptions",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "subscriptions_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.subscriptions",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_subscriptions_updated_at",
          "def": "CREATE TRIGGER update_subscriptions_updated_at BEFORE UPDATE ON public.subscriptions FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.teams",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "teams_pkey",
          "def": "CREATE UNIQUE INDEX teams_pkey ON public.teams USING btree (id)",
          "table": "public.teams",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_team_name_per_org",
          "def": "CREATE UNIQUE INDEX unique_team_name_per_org ON public.teams USING btree (org_id, name)",
          "table": "public.teams",
          "columns": [
            "org_id",
            "name"
          ]
        },
        {
          "name": "idx_teams_org_id",
          "def": "CREATE INDEX idx_teams_org_id ON public.teams USING btree (org_id)",
          "table": "public.teams",
          "columns": [
            "org_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "teams_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.teams",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "teams_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.teams",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_team_name_per_org",
          "type": "UNIQUE",
          "def": "UNIQUE (org_id, name)",
          "table": "public.teams",
          "referenced_table": "",
          "columns": [
            "org_id",
            "name"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_teams_updated_at",
          "def": "CREATE TRIGGER update_teams_updated_at BEFORE UPDATE ON public.teams FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.roles",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "description",
          "type": "text",
          "nullable": true
        },
        {
          "name": "permissions",
          "type": "jsonb",
          "nullable": false,
          "default": "'[]'::jsonb"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "roles_pkey",
          "def": "CREATE UNIQUE INDEX roles_pkey ON public.roles USING btree (id)",
          "table": "public.roles",
          "columns": [
            "id"
          ]
        },
        {
          "name": "roles_name_key",
          "def": "CREATE UNIQUE INDEX roles_name_key ON public.roles USING btree (name)",
          "table": "public.roles",
          "columns": [
            "name"
          ]
        }
      ],
      "constraints": [
        {
          "name": "roles_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.roles",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "roles_name_key",
          "type": "UNIQUE",
          "def": "UNIQUE (name)",
          "table": "public.roles",
          "referenced_table": "",
          "columns": [
            "name"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_roles_updated_at",
          "def": "CREATE TRIGGER update_roles_updated_at BEFORE UPDATE ON public.roles FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.employees",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "team_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "role_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "email",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "full_name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "password_hash",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'active'::character varying"
        },
        {
          "name": "preferences",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "personal_claude_token",
          "type": "text",
          "nullable": true
        },
        {
          "name": "last_login_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "deleted_at",
          "type": "timestamp without time zone",
          "nullable": true
        }
      ],
      "indexes": [
        {
          "name": "employees_pkey",
          "def": "CREATE UNIQUE INDEX employees_pkey ON public.employees USING btree (id)",
          "table": "public.employees",
          "columns": [
            "id"
          ]
        },
        {
          "name": "employees_email_key",
          "def": "CREATE UNIQUE INDEX employees_email_key ON public.employees USING btree (email)",
          "table": "public.employees",
          "columns": [
            "email"
          ]
        },
        {
          "name": "idx_employees_org_id",
          "def": "CREATE INDEX idx_employees_org_id ON public.employees USING btree (org_id)",
          "table": "public.employees",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "idx_employees_team_id",
          "def": "CREATE INDEX idx_employees_team_id ON public.employees USING btree (team_id)",
          "table": "public.employees",
          "columns": [
            "team_id"
          ]
        },
        {
          "name": "idx_employees_email",
          "def": "CREATE INDEX idx_employees_email ON public.employees USING btree (email)",
          "table": "public.employees",
          "columns": [
            "email"
          ]
        },
        {
          "name": "idx_employees_status",
          "def": "CREATE INDEX idx_employees_status ON public.employees USING btree (status)",
          "table": "public.employees",
          "columns": [
            "status"
          ]
        },
        {
          "name": "idx_employees_personal_token",
          "def": "CREATE INDEX idx_employees_personal_token ON public.employees USING btree (org_id, personal_claude_token) WHERE (personal_claude_token IS NOT NULL)",
          "table": "public.employees",
          "columns": [
            "org_id",
            "personal_claude_token"
          ]
        }
      ],
      "constraints": [
        {
          "name": "employees_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.employees",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employees_team_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE SET NULL",
          "table": "public.employees",
          "referenced_table": "teams",
          "columns": [
            "team_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employees_role_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (role_id) REFERENCES roles(id)",
          "table": "public.employees",
          "referenced_table": "roles",
          "columns": [
            "role_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employees_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.employees",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "employees_email_key",
          "type": "UNIQUE",
          "def": "UNIQUE (email)",
          "table": "public.employees",
          "referenced_table": "",
          "columns": [
            "email"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_employees_updated_at",
          "def": "CREATE TRIGGER update_employees_updated_at BEFORE UPDATE ON public.employees FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.sessions",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "token_hash",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "ip_address",
          "type": "varchar(45)",
          "nullable": true
        },
        {
          "name": "user_agent",
          "type": "text",
          "nullable": true
        },
        {
          "name": "expires_at",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "sessions_pkey",
          "def": "CREATE UNIQUE INDEX sessions_pkey ON public.sessions USING btree (id)",
          "table": "public.sessions",
          "columns": [
            "id"
          ]
        },
        {
          "name": "sessions_token_hash_key",
          "def": "CREATE UNIQUE INDEX sessions_token_hash_key ON public.sessions USING btree (token_hash)",
          "table": "public.sessions",
          "columns": [
            "token_hash"
          ]
        },
        {
          "name": "idx_sessions_employee_id",
          "def": "CREATE INDEX idx_sessions_employee_id ON public.sessions USING btree (employee_id)",
          "table": "public.sessions",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_sessions_token_hash",
          "def": "CREATE INDEX idx_sessions_token_hash ON public.sessions USING btree (token_hash)",
          "table": "public.sessions",
          "columns": [
            "token_hash"
          ]
        },
        {
          "name": "idx_sessions_expires_at",
          "def": "CREATE INDEX idx_sessions_expires_at ON public.sessions USING btree (expires_at)",
          "table": "public.sessions",
          "columns": [
            "expires_at"
          ]
        }
      ],
      "constraints": [
        {
          "name": "sessions_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.sessions",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "sessions_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.sessions",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "sessions_token_hash_key",
          "type": "UNIQUE",
          "def": "UNIQUE (token_hash)",
          "table": "public.sessions",
          "referenced_table": "",
          "columns": [
            "token_hash"
          ]
        }
      ]
    },
    {
      "name": "public.password_reset_tokens",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "token",
          "type": "varchar(64)",
          "nullable": false
        },
        {
          "name": "expires_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "(now() + '01:00:00'::interval)"
        },
        {
          "name": "used_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "password_reset_tokens_pkey",
          "def": "CREATE UNIQUE INDEX password_reset_tokens_pkey ON public.password_reset_tokens USING btree (id)",
          "table": "public.password_reset_tokens",
          "columns": [
            "id"
          ]
        },
        {
          "name": "password_reset_tokens_token_key",
          "def": "CREATE UNIQUE INDEX password_reset_tokens_token_key ON public.password_reset_tokens USING btree (token)",
          "table": "public.password_reset_tokens",
          "columns": [
            "token"
          ]
        },
        {
          "name": "idx_password_reset_tokens_token",
          "def": "CREATE INDEX idx_password_reset_tokens_token ON public.password_reset_tokens USING btree (token)",
          "table": "public.password_reset_tokens",
          "columns": [
            "token"
          ]
        },
        {
          "name": "idx_password_reset_tokens_employee_id",
          "def": "CREATE INDEX idx_password_reset_tokens_employee_id ON public.password_reset_tokens USING btree (employee_id)",
          "table": "public.password_reset_tokens",
          "columns": [
            "employee_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "password_reset_tokens_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.password_reset_tokens",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "password_reset_tokens_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.password_reset_tokens",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "password_reset_tokens_token_key",
          "type": "UNIQUE",
          "def": "UNIQUE (token)",
          "table": "public.password_reset_tokens",
          "referenced_table": "",
          "columns": [
            "token"
          ]
        }
      ]
    },
    {
      "name": "public.policies",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "name",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "type",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "rules",
          "type": "jsonb",
          "nullable": false
        },
        {
          "name": "severity",
          "type": "varchar(20)",
          "nullable": false,
          "default": "'warn'::character varying"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "policies_pkey",
          "def": "CREATE UNIQUE INDEX policies_pkey ON public.policies USING btree (id)",
          "table": "public.policies",
          "columns": [
            "id"
          ]
        },
        {
          "name": "policies_name_key",
          "def": "CREATE UNIQUE INDEX policies_name_key ON public.policies USING btree (name)",
          "table": "public.policies",
          "columns": [
            "name"
          ]
        }
      ],
      "constraints": [
        {
          "name": "policies_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.policies",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "policies_name_key",
          "type": "UNIQUE",
          "def": "UNIQUE (name)",
          "table": "public.policies",
          "referenced_table": "",
          "columns": [
            "name"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_policies_updated_at",
          "def": "CREATE TRIGGER update_policies_updated_at BEFORE UPDATE ON public.policies FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        }
      ]
    },
    {
      "name": "public.tool_policies",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "team_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "tool_name",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "conditions",
          "type": "jsonb",
          "nullable": true
        },
        {
          "name": "action",
          "type": "varchar(20)",
          "nullable": false,
          "default": "'deny'::character varying"
        },
        {
          "name": "reason",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_by",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "tool_policies_pkey",
          "def": "CREATE UNIQUE INDEX tool_policies_pkey ON public.tool_policies USING btree (id)",
          "table": "public.tool_policies",
          "columns": [
            "id"
          ]
        },
        {
          "name": "idx_tool_policies_org_id",
          "def": "CREATE INDEX idx_tool_policies_org_id ON public.tool_policies USING btree (org_id)",
          "table": "public.tool_policies",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "idx_tool_policies_team_id",
          "def": "CREATE INDEX idx_tool_policies_team_id ON public.tool_policies USING btree (team_id) WHERE (team_id IS NOT NULL)",
          "table": "public.tool_policies",
          "columns": [
            "team_id"
          ]
        },
        {
          "name": "idx_tool_policies_employee_id",
          "def": "CREATE INDEX idx_tool_policies_employee_id ON public.tool_policies USING btree (employee_id) WHERE (employee_id IS NOT NULL)",
          "table": "public.tool_policies",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_tool_policies_lookup",
          "def": "CREATE INDEX idx_tool_policies_lookup ON public.tool_policies USING btree (org_id, team_id, employee_id, tool_name)",
          "table": "public.tool_policies",
          "columns": [
            "org_id",
            "team_id",
            "employee_id",
            "tool_name"
          ]
        }
      ],
      "constraints": [
        {
          "name": "tool_policies_action_check",
          "type": "CHECK",
          "def": "CHECK (((action)::text = ANY ((ARRAY['deny'::character varying, 'audit'::character varying])::text[])))",
          "table": "public.tool_policies",
          "referenced_table": "",
          "columns": [
            "action"
          ]
        },
        {
          "name": "tool_policies_has_org",
          "type": "CHECK",
          "def": "CHECK ((org_id IS NOT NULL))",
          "table": "public.tool_policies",
          "referenced_table": "",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "tool_policies_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.tool_policies",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "tool_policies_team_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE CASCADE",
          "table": "public.tool_policies",
          "referenced_table": "teams",
          "columns": [
            "team_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "tool_policies_created_by_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (created_by) REFERENCES employees(id) ON DELETE SET NULL",
          "table": "public.tool_policies",
          "referenced_table": "employees",
          "columns": [
            "created_by"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "tool_policies_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.tool_policies",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "tool_policies_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.tool_policies",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ]
    },
    {
      "name": "public.team_policies",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "team_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "policy_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "overrides",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "team_policies_pkey",
          "def": "CREATE UNIQUE INDEX team_policies_pkey ON public.team_policies USING btree (id)",
          "table": "public.team_policies",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_team_policy",
          "def": "CREATE UNIQUE INDEX unique_team_policy ON public.team_policies USING btree (team_id, policy_id)",
          "table": "public.team_policies",
          "columns": [
            "team_id",
            "policy_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "team_policies_team_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE CASCADE",
          "table": "public.team_policies",
          "referenced_table": "teams",
          "columns": [
            "team_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "team_policies_policy_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (policy_id) REFERENCES policies(id) ON DELETE CASCADE",
          "table": "public.team_policies",
          "referenced_table": "policies",
          "columns": [
            "policy_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "team_policies_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.team_policies",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_team_policy",
          "type": "UNIQUE",
          "def": "UNIQUE (team_id, policy_id)",
          "table": "public.team_policies",
          "referenced_table": "",
          "columns": [
            "team_id",
            "policy_id"
          ]
        }
      ]
    },
    {
      "name": "public.employee_policies",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "policy_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "overrides",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "employee_policies_pkey",
          "def": "CREATE UNIQUE INDEX employee_policies_pkey ON public.employee_policies USING btree (id)",
          "table": "public.employee_policies",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_employee_policy",
          "def": "CREATE UNIQUE INDEX unique_employee_policy ON public.employee_policies USING btree (employee_id, policy_id)",
          "table": "public.employee_policies",
          "columns": [
            "employee_id",
            "policy_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "employee_policies_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.employee_policies",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employee_policies_policy_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (policy_id) REFERENCES policies(id) ON DELETE CASCADE",
          "table": "public.employee_policies",
          "referenced_table": "policies",
          "columns": [
            "policy_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "employee_policies_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.employee_policies",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "unique_employee_policy",
          "type": "UNIQUE",
          "def": "UNIQUE (employee_id, policy_id)",
          "table": "public.employee_policies",
          "referenced_table": "",
          "columns": [
            "employee_id",
            "policy_id"
          ]
        }
      ]
    },
    {
      "name": "public.activity_logs",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "session_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "client_name",
          "type": "varchar(100)",
          "nullable": true
        },
        {
          "name": "client_version",
          "type": "varchar(50)",
          "nullable": true
        },
        {
          "name": "event_type",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "event_category",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "content",
          "type": "text",
          "nullable": true
        },
        {
          "name": "payload",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "activity_logs_pkey",
          "def": "CREATE UNIQUE INDEX activity_logs_pkey ON public.activity_logs USING btree (id)",
          "table": "public.activity_logs",
          "columns": [
            "id"
          ]
        },
        {
          "name": "idx_activity_logs_org_id",
          "def": "CREATE INDEX idx_activity_logs_org_id ON public.activity_logs USING btree (org_id)",
          "table": "public.activity_logs",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "idx_activity_logs_employee_id",
          "def": "CREATE INDEX idx_activity_logs_employee_id ON public.activity_logs USING btree (employee_id)",
          "table": "public.activity_logs",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_activity_logs_session_id",
          "def": "CREATE INDEX idx_activity_logs_session_id ON public.activity_logs USING btree (session_id) WHERE (session_id IS NOT NULL)",
          "table": "public.activity_logs",
          "columns": [
            "session_id"
          ]
        },
        {
          "name": "idx_activity_logs_client",
          "def": "CREATE INDEX idx_activity_logs_client ON public.activity_logs USING btree (client_name)",
          "table": "public.activity_logs",
          "columns": [
            "client_name"
          ]
        },
        {
          "name": "idx_activity_logs_client_version",
          "def": "CREATE INDEX idx_activity_logs_client_version ON public.activity_logs USING btree (client_name, client_version)",
          "table": "public.activity_logs",
          "columns": [
            "client_name",
            "client_version"
          ]
        },
        {
          "name": "idx_activity_logs_event_type",
          "def": "CREATE INDEX idx_activity_logs_event_type ON public.activity_logs USING btree (event_type)",
          "table": "public.activity_logs",
          "columns": [
            "event_type"
          ]
        },
        {
          "name": "idx_activity_logs_created_at",
          "def": "CREATE INDEX idx_activity_logs_created_at ON public.activity_logs USING btree (created_at DESC)",
          "table": "public.activity_logs",
          "columns": [
            "created_at"
          ]
        },
        {
          "name": "idx_activity_logs_session_created",
          "def": "CREATE INDEX idx_activity_logs_session_created ON public.activity_logs USING btree (session_id, created_at) WHERE (session_id IS NOT NULL)",
          "table": "public.activity_logs",
          "columns": [
            "session_id",
            "created_at"
          ]
        }
      ],
      "constraints": [
        {
          "name": "activity_logs_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.activity_logs",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "activity_logs_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE SET NULL",
          "table": "public.activity_logs",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "activity_logs_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.activity_logs",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ]
    },
    {
      "name": "public.usage_records",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "resource_type",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "quantity",
          "type": "bigint",
          "nullable": false
        },
        {
          "name": "cost_usd",
          "type": "numeric(10,4)",
          "nullable": false
        },
        {
          "name": "period_start",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "period_end",
          "type": "timestamp without time zone",
          "nullable": false
        },
        {
          "name": "metadata",
          "type": "jsonb",
          "nullable": false,
          "default": "'{}'::jsonb"
        },
        {
          "name": "token_source",
          "type": "varchar(20)",
          "nullable": true,
          "default": "'company'::character varying"
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "usage_records_pkey",
          "def": "CREATE UNIQUE INDEX usage_records_pkey ON public.usage_records USING btree (id)",
          "table": "public.usage_records",
          "columns": [
            "id"
          ]
        },
        {
          "name": "idx_usage_records_org_id",
          "def": "CREATE INDEX idx_usage_records_org_id ON public.usage_records USING btree (org_id)",
          "table": "public.usage_records",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "idx_usage_records_employee_id",
          "def": "CREATE INDEX idx_usage_records_employee_id ON public.usage_records USING btree (employee_id)",
          "table": "public.usage_records",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_usage_records_period",
          "def": "CREATE INDEX idx_usage_records_period ON public.usage_records USING btree (period_start, period_end)",
          "table": "public.usage_records",
          "columns": [
            "period_start",
            "period_end"
          ]
        }
      ],
      "constraints": [
        {
          "name": "usage_records_token_source_check",
          "type": "CHECK",
          "def": "CHECK (((token_source)::text = ANY ((ARRAY['company'::character varying, 'personal'::character varying])::text[])))",
          "table": "public.usage_records",
          "referenced_table": "",
          "columns": [
            "token_source"
          ]
        },
        {
          "name": "usage_records_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.usage_records",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "usage_records_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE SET NULL",
          "table": "public.usage_records",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "usage_records_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.usage_records",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ]
    },
    {
      "name": "public.webhook_destinations",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "name",
          "type": "varchar(100)",
          "nullable": false
        },
        {
          "name": "url",
          "type": "text",
          "nullable": false
        },
        {
          "name": "auth_type",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'none'::character varying"
        },
        {
          "name": "auth_config",
          "type": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb"
        },
        {
          "name": "event_types",
          "type": "text[]",
          "nullable": true,
          "default": "'{}'::text[]"
        },
        {
          "name": "event_filter",
          "type": "jsonb",
          "nullable": true,
          "default": "'{}'::jsonb"
        },
        {
          "name": "enabled",
          "type": "boolean",
          "nullable": false,
          "default": "true"
        },
        {
          "name": "batch_size",
          "type": "integer",
          "nullable": false,
          "default": "1"
        },
        {
          "name": "timeout_ms",
          "type": "integer",
          "nullable": false,
          "default": "5000"
        },
        {
          "name": "retry_max",
          "type": "integer",
          "nullable": false,
          "default": "3"
        },
        {
          "name": "retry_backoff_ms",
          "type": "integer",
          "nullable": false,
          "default": "1000"
        },
        {
          "name": "signing_secret",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "created_by",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "webhook_destinations_pkey",
          "def": "CREATE UNIQUE INDEX webhook_destinations_pkey ON public.webhook_destinations USING btree (id)",
          "table": "public.webhook_destinations",
          "columns": [
            "id"
          ]
        },
        {
          "name": "webhook_destinations_org_id_name_key",
          "def": "CREATE UNIQUE INDEX webhook_destinations_org_id_name_key ON public.webhook_destinations USING btree (org_id, name)",
          "table": "public.webhook_destinations",
          "columns": [
            "org_id",
            "name"
          ]
        },
        {
          "name": "idx_webhook_destinations_org_id",
          "def": "CREATE INDEX idx_webhook_destinations_org_id ON public.webhook_destinations USING btree (org_id)",
          "table": "public.webhook_destinations",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "idx_webhook_destinations_enabled",
          "def": "CREATE INDEX idx_webhook_destinations_enabled ON public.webhook_destinations USING btree (org_id, enabled) WHERE (enabled = true)",
          "table": "public.webhook_destinations",
          "columns": [
            "org_id",
            "enabled"
          ]
        }
      ],
      "constraints": [
        {
          "name": "webhook_destinations_auth_type_check",
          "type": "CHECK",
          "def": "CHECK (((auth_type)::text = ANY ((ARRAY['none'::character varying, 'bearer'::character varying, 'header'::character varying, 'basic'::character varying])::text[])))",
          "table": "public.webhook_destinations",
          "referenced_table": "",
          "columns": [
            "auth_type"
          ]
        },
        {
          "name": "webhook_destinations_batch_size_check",
          "type": "CHECK",
          "def": "CHECK (((batch_size \u003e= 1) AND (batch_size \u003c= 100)))",
          "table": "public.webhook_destinations",
          "referenced_table": "",
          "columns": [
            "batch_size"
          ]
        },
        {
          "name": "webhook_destinations_retry_backoff_ms_check",
          "type": "CHECK",
          "def": "CHECK ((retry_backoff_ms \u003e= 100))",
          "table": "public.webhook_destinations",
          "referenced_table": "",
          "columns": [
            "retry_backoff_ms"
          ]
        },
        {
          "name": "webhook_destinations_retry_max_check",
          "type": "CHECK",
          "def": "CHECK (((retry_max \u003e= 0) AND (retry_max \u003c= 10)))",
          "table": "public.webhook_destinations",
          "referenced_table": "",
          "columns": [
            "retry_max"
          ]
        },
        {
          "name": "webhook_destinations_timeout_ms_check",
          "type": "CHECK",
          "def": "CHECK (((timeout_ms \u003e= 1000) AND (timeout_ms \u003c= 30000)))",
          "table": "public.webhook_destinations",
          "referenced_table": "",
          "columns": [
            "timeout_ms"
          ]
        },
        {
          "name": "webhook_destinations_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.webhook_destinations",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "webhook_destinations_created_by_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (created_by) REFERENCES employees(id) ON DELETE SET NULL",
          "table": "public.webhook_destinations",
          "referenced_table": "employees",
          "columns": [
            "created_by"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "webhook_destinations_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.webhook_destinations",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "webhook_destinations_org_id_name_key",
          "type": "UNIQUE",
          "def": "UNIQUE (org_id, name)",
          "table": "public.webhook_destinations",
          "referenced_table": "",
          "columns": [
            "org_id",
            "name"
          ]
        }
      ]
    },
    {
      "name": "public.webhook_deliveries",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "gen_random_uuid()"
        },
        {
          "name": "destination_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "log_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'pending'::character varying"
        },
        {
          "name": "attempts",
          "type": "integer",
          "nullable": false,
          "default": "0"
        },
        {
          "name": "last_attempt_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "next_retry_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "response_status",
          "type": "integer",
          "nullable": true
        },
        {
          "name": "response_body",
          "type": "text",
          "nullable": true
        },
        {
          "name": "error_message",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "delivered_at",
          "type": "timestamp without time zone",
          "nullable": true
        }
      ],
      "indexes": [
        {
          "name": "webhook_deliveries_pkey",
          "def": "CREATE UNIQUE INDEX webhook_deliveries_pkey ON public.webhook_deliveries USING btree (id)",
          "table": "public.webhook_deliveries",
          "columns": [
            "id"
          ]
        },
        {
          "name": "webhook_deliveries_destination_id_log_id_key",
          "def": "CREATE UNIQUE INDEX webhook_deliveries_destination_id_log_id_key ON public.webhook_deliveries USING btree (destination_id, log_id)",
          "table": "public.webhook_deliveries",
          "columns": [
            "destination_id",
            "log_id"
          ]
        },
        {
          "name": "idx_webhook_deliveries_pending",
          "def": "CREATE INDEX idx_webhook_deliveries_pending ON public.webhook_deliveries USING btree (status, next_retry_at) WHERE ((status)::text = ANY ((ARRAY['pending'::character varying, 'failed'::character varying])::text[]))",
          "table": "public.webhook_deliveries",
          "columns": [
            "status",
            "next_retry_at"
          ]
        },
        {
          "name": "idx_webhook_deliveries_destination",
          "def": "CREATE INDEX idx_webhook_deliveries_destination ON public.webhook_deliveries USING btree (destination_id)",
          "table": "public.webhook_deliveries",
          "columns": [
            "destination_id"
          ]
        },
        {
          "name": "idx_webhook_deliveries_log",
          "def": "CREATE INDEX idx_webhook_deliveries_log ON public.webhook_deliveries USING btree (log_id)",
          "table": "public.webhook_deliveries",
          "columns": [
            "log_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "webhook_deliveries_status_check",
          "type": "CHECK",
          "def": "CHECK (((status)::text = ANY ((ARRAY['pending'::character varying, 'delivered'::character varying, 'failed'::character varying, 'dead'::character varying])::text[])))",
          "table": "public.webhook_deliveries",
          "referenced_table": "",
          "columns": [
            "status"
          ]
        },
        {
          "name": "webhook_deliveries_log_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (log_id) REFERENCES activity_logs(id) ON DELETE CASCADE",
          "table": "public.webhook_deliveries",
          "referenced_table": "activity_logs",
          "columns": [
            "log_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "webhook_deliveries_destination_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (destination_id) REFERENCES webhook_destinations(id) ON DELETE CASCADE",
          "table": "public.webhook_deliveries",
          "referenced_table": "webhook_destinations",
          "columns": [
            "destination_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "webhook_deliveries_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.webhook_deliveries",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "webhook_deliveries_destination_id_log_id_key",
          "type": "UNIQUE",
          "def": "UNIQUE (destination_id, log_id)",
          "table": "public.webhook_deliveries",
          "referenced_table": "",
          "columns": [
            "destination_id",
            "log_id"
          ]
        }
      ]
    },
    {
      "name": "public.agent_requests",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "request_type",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "request_data",
          "type": "jsonb",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'pending'::character varying"
        },
        {
          "name": "reason",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "resolved_at",
          "type": "timestamp without time zone",
          "nullable": true
        }
      ],
      "indexes": [
        {
          "name": "agent_requests_pkey",
          "def": "CREATE UNIQUE INDEX agent_requests_pkey ON public.agent_requests USING btree (id)",
          "table": "public.agent_requests",
          "columns": [
            "id"
          ]
        },
        {
          "name": "idx_agent_requests_employee_id",
          "def": "CREATE INDEX idx_agent_requests_employee_id ON public.agent_requests USING btree (employee_id)",
          "table": "public.agent_requests",
          "columns": [
            "employee_id"
          ]
        },
        {
          "name": "idx_agent_requests_status",
          "def": "CREATE INDEX idx_agent_requests_status ON public.agent_requests USING btree (status)",
          "table": "public.agent_requests",
          "columns": [
            "status"
          ]
        },
        {
          "name": "idx_agent_requests_created_at",
          "def": "CREATE INDEX idx_agent_requests_created_at ON public.agent_requests USING btree (created_at DESC)",
          "table": "public.agent_requests",
          "columns": [
            "created_at"
          ]
        }
      ],
      "constraints": [
        {
          "name": "agent_requests_employee_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.agent_requests",
          "referenced_table": "employees",
          "columns": [
            "employee_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "agent_requests_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.agent_requests",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ]
    },
    {
      "name": "public.approvals",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "request_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "approver_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false
        },
        {
          "name": "comment",
          "type": "text",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "resolved_at",
          "type": "timestamp without time zone",
          "nullable": true
        }
      ],
      "indexes": [
        {
          "name": "approvals_pkey",
          "def": "CREATE UNIQUE INDEX approvals_pkey ON public.approvals USING btree (id)",
          "table": "public.approvals",
          "columns": [
            "id"
          ]
        },
        {
          "name": "idx_approvals_request_id",
          "def": "CREATE INDEX idx_approvals_request_id ON public.approvals USING btree (request_id)",
          "table": "public.approvals",
          "columns": [
            "request_id"
          ]
        },
        {
          "name": "idx_approvals_approver_id",
          "def": "CREATE INDEX idx_approvals_approver_id ON public.approvals USING btree (approver_id)",
          "table": "public.approvals",
          "columns": [
            "approver_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "approvals_approver_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (approver_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.approvals",
          "referenced_table": "employees",
          "columns": [
            "approver_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "approvals_request_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (request_id) REFERENCES agent_requests(id) ON DELETE CASCADE",
          "table": "public.approvals",
          "referenced_table": "agent_requests",
          "columns": [
            "request_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "approvals_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.approvals",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        }
      ]
    },
    {
      "name": "public.invitations",
      "type": "BASE TABLE",
      "columns": [
        {
          "name": "id",
          "type": "uuid",
          "nullable": false,
          "default": "uuid_generate_v4()"
        },
        {
          "name": "org_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "inviter_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "email",
          "type": "varchar(255)",
          "nullable": false
        },
        {
          "name": "role_id",
          "type": "uuid",
          "nullable": false
        },
        {
          "name": "team_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "token",
          "type": "varchar(64)",
          "nullable": false
        },
        {
          "name": "status",
          "type": "varchar(50)",
          "nullable": false,
          "default": "'pending'::character varying"
        },
        {
          "name": "expires_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "(now() + '7 days'::interval)"
        },
        {
          "name": "accepted_by",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "accepted_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "created_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        },
        {
          "name": "updated_at",
          "type": "timestamp without time zone",
          "nullable": false,
          "default": "now()"
        }
      ],
      "indexes": [
        {
          "name": "invitations_pkey",
          "def": "CREATE UNIQUE INDEX invitations_pkey ON public.invitations USING btree (id)",
          "table": "public.invitations",
          "columns": [
            "id"
          ]
        },
        {
          "name": "invitations_token_key",
          "def": "CREATE UNIQUE INDEX invitations_token_key ON public.invitations USING btree (token)",
          "table": "public.invitations",
          "columns": [
            "token"
          ]
        },
        {
          "name": "unique_pending_invitation",
          "def": "CREATE UNIQUE INDEX unique_pending_invitation ON public.invitations USING btree (org_id, email, status)",
          "table": "public.invitations",
          "columns": [
            "org_id",
            "email",
            "status"
          ]
        },
        {
          "name": "idx_invitations_org_id",
          "def": "CREATE INDEX idx_invitations_org_id ON public.invitations USING btree (org_id)",
          "table": "public.invitations",
          "columns": [
            "org_id"
          ]
        },
        {
          "name": "idx_invitations_email",
          "def": "CREATE INDEX idx_invitations_email ON public.invitations USING btree (email)",
          "table": "public.invitations",
          "columns": [
            "email"
          ]
        },
        {
          "name": "idx_invitations_token",
          "def": "CREATE INDEX idx_invitations_token ON public.invitations USING btree (token)",
          "table": "public.invitations",
          "columns": [
            "token"
          ]
        },
        {
          "name": "idx_invitations_status",
          "def": "CREATE INDEX idx_invitations_status ON public.invitations USING btree (status)",
          "table": "public.invitations",
          "columns": [
            "status"
          ]
        },
        {
          "name": "idx_invitations_expires_at",
          "def": "CREATE INDEX idx_invitations_expires_at ON public.invitations USING btree (expires_at)",
          "table": "public.invitations",
          "columns": [
            "expires_at"
          ]
        },
        {
          "name": "idx_invitations_inviter_id",
          "def": "CREATE INDEX idx_invitations_inviter_id ON public.invitations USING btree (inviter_id)",
          "table": "public.invitations",
          "columns": [
            "inviter_id"
          ]
        }
      ],
      "constraints": [
        {
          "name": "invitations_org_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE",
          "table": "public.invitations",
          "referenced_table": "organizations",
          "columns": [
            "org_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "invitations_team_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE SET NULL",
          "table": "public.invitations",
          "referenced_table": "teams",
          "columns": [
            "team_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "invitations_role_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (role_id) REFERENCES roles(id)",
          "table": "public.invitations",
          "referenced_table": "roles",
          "columns": [
            "role_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "invitations_accepted_by_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (accepted_by) REFERENCES employees(id) ON DELETE SET NULL",
          "table": "public.invitations",
          "referenced_table": "employees",
          "columns": [
            "accepted_by"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "invitations_inviter_id_fkey",
          "type": "FOREIGN KEY",
          "def": "FOREIGN KEY (inviter_id) REFERENCES employees(id) ON DELETE CASCADE",
          "table": "public.invitations",
          "referenced_table": "employees",
          "columns": [
            "inviter_id"
          ],
          "referenced_columns": [
            "id"
          ]
        },
        {
          "name": "invitations_pkey",
          "type": "PRIMARY KEY",
          "def": "PRIMARY KEY (id)",
          "table": "public.invitations",
          "referenced_table": "",
          "columns": [
            "id"
          ]
        },
        {
          "name": "invitations_token_key",
          "type": "UNIQUE",
          "def": "UNIQUE (token)",
          "table": "public.invitations",
          "referenced_table": "",
          "columns": [
            "token"
          ]
        },
        {
          "name": "unique_pending_invitation",
          "type": "UNIQUE",
          "def": "UNIQUE (org_id, email, status)",
          "table": "public.invitations",
          "referenced_table": "",
          "columns": [
            "org_id",
            "email",
            "status"
          ]
        }
      ],
      "triggers": [
        {
          "name": "update_invitations_updated_at",
          "def": "CREATE TRIGGER update_invitations_updated_at BEFORE UPDATE ON public.invitations FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()"
        },
        {
          "name": "generate_invitation_token_trigger",
          "def": "CREATE TRIGGER generate_invitation_token_trigger BEFORE INSERT ON public.invitations FOR EACH ROW EXECUTE FUNCTION generate_invitation_token()"
        }
      ]
    },
    {
      "name": "public.v_pending_approvals",
      "type": "VIEW",
      "comment": "Pending approval requests with full requester context",
      "columns": [
        {
          "name": "request_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "request_type",
          "type": "varchar(50)",
          "nullable": true
        },
        {
          "name": "request_data",
          "type": "jsonb",
          "nullable": true
        },
        {
          "name": "reason",
          "type": "text",
          "nullable": true
        },
        {
          "name": "requested_at",
          "type": "timestamp without time zone",
          "nullable": true
        },
        {
          "name": "employee_id",
          "type": "uuid",
          "nullable": true
        },
        {
          "name": "requester_name",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "requester_email",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "team_name",
          "type": "varchar(255)",
          "nullable": true
        },
        {
          "name": "org_name",
          "type": "varchar(255)",
          "nullable": true
        }
      ],
      "def": "CREATE VIEW v_pending_approvals AS (\n SELECT ar.id AS request_id,\n    ar.request_type,\n    ar.request_data,\n    ar.reason,\n    ar.created_at AS requested_at,\n    e.id AS employee_id,\n    e.full_name AS requester_name,\n    e.email AS requester_email,\n    t.name AS team_name,\n    o.name AS org_name\n   FROM (((agent_requests ar\n     JOIN employees e ON ((ar.employee_id = e.id)))\n     JOIN organizations o ON ((e.org_id = o.id)))\n     LEFT JOIN teams t ON ((e.team_id = t.id)))\n  WHERE ((ar.status)::text = 'pending'::text)\n)",
      "referenced_tables": [
        "public.agent_requests",
        "public.employees",
        "public.organizations",
        "public.teams"
      ]
    }
  ],
  "relations": [
    {
      "table": "public.subscriptions",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.teams",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.employees",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.employees",
      "columns": [
        "team_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.teams",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE SET NULL"
    },
    {
      "table": "public.employees",
      "columns": [
        "role_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.roles",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (role_id) REFERENCES roles(id)"
    },
    {
      "table": "public.sessions",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.password_reset_tokens",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.tool_policies",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.tool_policies",
      "columns": [
        "team_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.teams",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE CASCADE"
    },
    {
      "table": "public.tool_policies",
      "columns": [
        "created_by"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (created_by) REFERENCES employees(id) ON DELETE SET NULL"
    },
    {
      "table": "public.tool_policies",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.team_policies",
      "columns": [
        "team_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.teams",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE CASCADE"
    },
    {
      "table": "public.team_policies",
      "columns": [
        "policy_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.policies",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (policy_id) REFERENCES policies(id) ON DELETE CASCADE"
    },
    {
      "table": "public.employee_policies",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.employee_policies",
      "columns": [
        "policy_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.policies",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (policy_id) REFERENCES policies(id) ON DELETE CASCADE"
    },
    {
      "table": "public.activity_logs",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.activity_logs",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE SET NULL"
    },
    {
      "table": "public.usage_records",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.usage_records",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE SET NULL"
    },
    {
      "table": "public.webhook_destinations",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.webhook_destinations",
      "columns": [
        "created_by"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (created_by) REFERENCES employees(id) ON DELETE SET NULL"
    },
    {
      "table": "public.webhook_deliveries",
      "columns": [
        "log_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.activity_logs",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (log_id) REFERENCES activity_logs(id) ON DELETE CASCADE"
    },
    {
      "table": "public.webhook_deliveries",
      "columns": [
        "destination_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.webhook_destinations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (destination_id) REFERENCES webhook_destinations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.agent_requests",
      "columns": [
        "employee_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (employee_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.approvals",
      "columns": [
        "approver_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (approver_id) REFERENCES employees(id) ON DELETE CASCADE"
    },
    {
      "table": "public.approvals",
      "columns": [
        "request_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.agent_requests",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (request_id) REFERENCES agent_requests(id) ON DELETE CASCADE"
    },
    {
      "table": "public.invitations",
      "columns": [
        "org_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.organizations",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE"
    },
    {
      "table": "public.invitations",
      "columns": [
        "team_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.teams",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (team_id) REFERENCES teams(id) ON DELETE SET NULL"
    },
    {
      "table": "public.invitations",
      "columns": [
        "role_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.roles",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (role_id) REFERENCES roles(id)"
    },
    {
      "table": "public.invitations",
      "columns": [
        "accepted_by"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "zero_or_one",
      "def": "FOREIGN KEY (accepted_by) REFERENCES employees(id) ON DELETE SET NULL"
    },
    {
      "table": "public.invitations",
      "columns": [
        "inviter_id"
      ],
      "cardinality": "zero_or_more",
      "parent_table": "public.employees",
      "parent_columns": [
        "id"
      ],
      "parent_cardinality": "exactly_one",
      "def": "FOREIGN KEY (inviter_id) REFERENCES employees(id) ON DELETE CASCADE"
    }
  ],
  "functions": [
    {
      "name": "public.uuid_nil",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_ns_dns",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_ns_url",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_ns_oid",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_ns_x500",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v1",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v1mc",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v3",
      "return_type": "uuid",
      "arguments": "namespace uuid, name text",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v4",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.uuid_generate_v5",
      "return_type": "uuid",
      "arguments": "namespace uuid, name text",
      "type": "FUNCTION"
    },
    {
      "name": "public.digest",
      "return_type": "bytea",
      "arguments": "text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.digest",
      "return_type": "bytea",
      "arguments": "bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.hmac",
      "return_type": "bytea",
      "arguments": "text, text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.hmac",
      "return_type": "bytea",
      "arguments": "bytea, bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.crypt",
      "return_type": "text",
      "arguments": "text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.gen_salt",
      "return_type": "text",
      "arguments": "text",
      "type": "FUNCTION"
    },
    {
      "name": "public.gen_salt",
      "return_type": "text",
      "arguments": "text, integer",
      "type": "FUNCTION"
    },
    {
      "name": "public.encrypt",
      "return_type": "bytea",
      "arguments": "bytea, bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.decrypt",
      "return_type": "bytea",
      "arguments": "bytea, bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.encrypt_iv",
      "return_type": "bytea",
      "arguments": "bytea, bytea, bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.decrypt_iv",
      "return_type": "bytea",
      "arguments": "bytea, bytea, bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.gen_random_bytes",
      "return_type": "bytea",
      "arguments": "integer",
      "type": "FUNCTION"
    },
    {
      "name": "public.gen_random_uuid",
      "return_type": "uuid",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_sym_encrypt",
      "return_type": "bytea",
      "arguments": "text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_sym_encrypt_bytea",
      "return_type": "bytea",
      "arguments": "bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_sym_encrypt",
      "return_type": "bytea",
      "arguments": "text, text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_sym_encrypt_bytea",
      "return_type": "bytea",
      "arguments": "bytea, text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_sym_decrypt",
      "return_type": "text",
      "arguments": "bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_sym_decrypt_bytea",
      "return_type": "bytea",
      "arguments": "bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_sym_decrypt",
      "return_type": "text",
      "arguments": "bytea, text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_sym_decrypt_bytea",
      "return_type": "bytea",
      "arguments": "bytea, text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_encrypt",
      "return_type": "bytea",
      "arguments": "text, bytea",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_encrypt_bytea",
      "return_type": "bytea",
      "arguments": "bytea, bytea",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_encrypt",
      "return_type": "bytea",
      "arguments": "text, bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_encrypt_bytea",
      "return_type": "bytea",
      "arguments": "bytea, bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_decrypt",
      "return_type": "text",
      "arguments": "bytea, bytea",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_decrypt_bytea",
      "return_type": "bytea",
      "arguments": "bytea, bytea",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_decrypt",
      "return_type": "text",
      "arguments": "bytea, bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_decrypt_bytea",
      "return_type": "bytea",
      "arguments": "bytea, bytea, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_decrypt",
      "return_type": "text",
      "arguments": "bytea, bytea, text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_pub_decrypt_bytea",
      "return_type": "bytea",
      "arguments": "bytea, bytea, text, text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_key_id",
      "return_type": "text",
      "arguments": "bytea",
      "type": "FUNCTION"
    },
    {
      "name": "public.armor",
      "return_type": "text",
      "arguments": "bytea",
      "type": "FUNCTION"
    },
    {
      "name": "public.armor",
      "return_type": "text",
      "arguments": "bytea, text[], text[]",
      "type": "FUNCTION"
    },
    {
      "name": "public.dearmor",
      "return_type": "bytea",
      "arguments": "text",
      "type": "FUNCTION"
    },
    {
      "name": "public.pgp_armor_headers",
      "return_type": "record",
      "arguments": "text, OUT key text, OUT value text",
      "type": "FUNCTION"
    },
    {
      "name": "public.update_updated_at_column",
      "return_type": "trigger",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.generate_invitation_token",
      "return_type": "trigger",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.expire_old_invitations",
      "return_type": "void",
      "arguments": "",
      "type": "FUNCTION"
    },
    {
      "name": "public.get_effective_claude_token",
      "return_type": "record",
      "arguments": "emp_id uuid",
      "type": "FUNCTION"
    }
  ],
  "driver": {
    "name": "postgres",
    "database_version": "PostgreSQL 15.15 on aarch64-unknown-linux-musl, compiled by gcc (Alpine 15.2.0) 15.2.0, 64-bit",
    "meta": {
      "current_schema": "public",
      "search_paths": [
        "arfa",
        "public"
      ],
      "dict": {
        "Functions": "Stored procedures and functions"
      }
    }
  }
}
